id: https://www.cdisc.org/ars/1-0
title: Analysis Results Standard (ARS)
name: ars_ldm

imports:
  - linkml:types

prefixes:
  linkml: https://w3id.org/linkml/
  ars: https://www.cdisc.org/ars/1-0
  bioregistry: https://bioregistry.io/registry/
  NCIT: http://purl.obolibrary.org/obo/NCIT_
#  def: http://www.cdisc.org/ns/def/v2.1
  NCIThesaurus: http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl#
  defCT: https://api.library.cdisc.org/api/mdr/root/ct/define/codelists/

default_prefix: ars

default_range: string

classes:

  NamedObject:
    abstract: true
    slots:
      - name

  ReportingEvent:
    description: A set of analyses and outputs created to meet a specific reporting requirement, such as a CSR or interim analysis.
    tree_root: true
    is_a: NamedObject
    slots:
      - listOfPlannedAnalyses
      - listOfPlannedOutputs
      - analysisSets
      - analysisGroupings
      - dataSubsets
      - dataGroupings
      - globalDisplaySections
      - analysisCategorizations
      - analyses
      - methods
      - outputs
      - referenceDocuments
      - terminologyExtentions

  NestedList:
    description: A list of items (analyses or outputs) that may be organized within sub-lists.
    slots:
      - listItems

  OrderedListItem:
    description: An item (analysis, output or sub-list) ordered relative to other items within a list or sub-list.
    is_a: NamedObject
    slots:
      - level
      - order
      - sublist
      - analysisId
      - outputId
    slot_usage:
      level:
        required: true
      order:
        required: true

  AnalysisCategorization:
    description: A set of related implementer-defined categories that can be used to categorize analyses or outputs.
    slots:
      - id
      - label
      - categories

  AnalysisCategory:
    description: An implementer-defined category of analyses/outputs, which may include one or more sub-categorization.
    slots:
      - id
      - label
      - subCategorizations

  Analysis:
    description: |
      An analysis that is designed to meet a requirement of the reporting event. Each analysis is defined as a set of specifications, including:
      - The analysis variable that is the subject of the analysis.
      - The analysis method (set of statistical operations) that is performed for the analysis variable.
      - The analysis set (subject population) for which the analysis is performed.
      - The subset of data records on which the analysis is performed (optional).
      - One or more factors by which either subjects or data records are grouped for analysis (optional).
    is_a: NamedObject
    slots:
      - id
      - version
      - categoryIds
      - description
      - documentRefs
      - reason
      - purpose
      - analysisSetId
      - orderedGroupings
      - dataSubsetId
      - dataset
      - variable
      - methodId
      - referencedAnalysisOperations
      - results

  OrderedGroupingFactor:
    description: A reference to a defined factor by which subjects or data records are grouped for the analysis, ordered with respect to other grouping factors.      
    slots:
      - order
      - groupingId
      - resultsByGroup
    slot_usage:
      order:
        required: true

  ReferencedAnalysisOperation:
    description: An indication of the analysis that contains results of a referenced operation.
    slots:
      - referencedOperationId
      - analysisId
    slot_usage:
      analysisId:
        required: true

  OperationResult:
    description: The result of an analysis method operation performed on a subdivision of subjects or data records.
    slots:
      - operationId
      - resultGroups
      - rawValue
      - formattedValue

  ResultGroup:
    description: For the specified grouping factor, an indication of the specific group of subjects or data records associated with the analysis result.
    slots:
      - groupingId
      - groupId
      - groupValue
  
  AnalysisMethod:
    description: A set of one or more statistical operations.
    is_a: NamedObject
    slots:
      - id
      - label
      - description
      - operations
      - codeTemplate

  Operation:
    description: A statistical operation that produces a single analysis result value as part of an analysis method.
    is_a: NamedObject
    slots:
      - id
      - label
      - referencedOperationRelationships
      - resultPattern

  ReferencedOperationRelationship:
    description: A reference to an statistical operation whose results is used in the calculation of the result for this operation.
    slots:
      - id
      - referencedOperationRole
      - operationId
      - analysisId
      - description

  ProgrammingCodeTemplate:
    description: 
    slots:
      - context
      - parameters
      - templateCode

  CodeParameter:
    is_a: NamedObject
    description:
    slots:
      - description
      - valueSource

  Output:
    slots:
      - id
      - version
      - fileSpecifications
      - displays
      - categoryIds
    slot_usage:
      categoryIds:
        required: false
        inlined: false

  File:
    is_a: NamedObject
    slots:
      - fileType
      - location
      - style

  OrderedDisplay:
    slots:
      - order
      - display
    slot_usage:
      order:
        required: true

  OutputDisplay:
    is_a: NamedObject
    slots:
      - id
      - version
      - displayTitle
      - displaySections

  DisplaySection:
    slots:
      - sectionType
      - subSections

  DisplaySubSection:
    slots:
      - id
      - order
      - text    
    slot_usage:
      order:
        required: true

  WhereClause:
    slots:
      - level
      - order
      - condition
      - compoundExpression

  WhereClauseCondition:
    slots:
      - dataset
      - variable
      - comparator
      - value

  WhereClauseCompoundExpression:
    slots:
      - logicalOperator
      - whereClauses

  CompoundSetExpression:
    is_a: WhereClauseCompoundExpression
    slot_usage:
      whereClauses:
        range: AnalysisSet
        inlined: false

  CompoundGroupExpression:
    is_a: WhereClauseCompoundExpression
    slot_usage:
      whereClauses:
        range: Group
        inlined: false

  CompoundSubsetExpression:
    is_a: WhereClauseCompoundExpression
    slot_usage:
      whereClauses:
        inlined: true
        inlined_as_list: true

  AnalysisSet:
    description: >-
      A set of subjects whose data are to be included in the main analyses.
      This should be defined in the statistical section of the protocol.
      NOTE: There are a number of potential analysis sets, including,
      for example, the set based upon the intent-to-treat principle. [ICH E9]
    is_a: WhereClause
    slot_usage:
      compoundExpression:
        range: CompoundSetExpression
    slots:
      - id
      - label

  GroupingFactor:
    abstract: true
    description: A factor used to subdivide either the subject population or data records in an analysis dataset for analysis.
    slots:
      - id
      - label
      - groupingVariable
      - dataDriven
      - groups

  SubjectGroupingFactor:
    is_a: GroupingFactor
    description: A factor used to subdivide the subject population for comparative analysis (e.g., treatment, sex, race, age).
    slot_usage:
      groups:
        range: AnalysisGroup

  DataGroupingFactor:
    is_a: GroupingFactor
    description: A factor used to subdivide data records in an analysis dataset for analysis.
    slot_usage:
      groups:
        range: DataGroup

  Group:
    description: A subdivision of the subject population or analysis dataset record set based on a defined factor.
    is_a: WhereClause
    slot_usage:
      compoundExpression:
        range: CompoundGroupExpression
    slots:
      - id
      - label

  AnalysisGroup:
    description: A subdivision of the subject population based on a defined factor (e.g., subjects whose treatment is Drug A, subjects whose gender is male).
    is_a: Group

  DataGroup:
    description: A subdivision of the analysis dataset records based on a defined factor.
    is_a: Group

  DataSubset:
    description: A subset of data identified by selection criteria for inclusion in the analysis.
    is_a: WhereClause
    slot_usage:
      compoundExpression:
        range: CompoundSubsetExpression
    slots:
      - id
      - label

  ReferenceDocument:
    is_a: NamedObject
    slots:
      - id
      - location

  DocumentRef:
    slots:
      - referenceDocumentId
      - pageRefs

  PageRef:
    slots:
      - refType
      - label
      - pages

  PageNumberListRef:
    description: One or more individual pages in the reference document, referenced by page number.
    is_a: PageRef
    slot_usage:
      refType:
        equals_string: PhysicalRef
      pages:
        range: PageNumberList

  PageNumberRangeRef:
    description: A range of pages in the reference document, indicated by the first and last page number in the range.
    is_a: PageRef
    slot_usage:
      refType:
        equals_string: PhysicalRef
      pages:
        range: PageRange

  PageNameRef:
    description: One or more pages in the reference document, referenced by named destination.
    is_a: PageRef
    slot_usage:
      refType:
        equals_string: NamedDestination
      pages:
        range: PageNameList

  PageNumberList:
    description: A list of one or more page numbers.
    slots:
      - pageNumbers

  PageNameList:
    description: A list of one or more named document references, each of which corresponds with a page.
    slots:
      - pageNames

  PageRange:
    description: A set of pages in a document that includes the specified first and last page, and all pages in between.
    slots:
      - firstPage
      - lastPage

  TerminologyExtension:
    description: A sponsor-defined term that is included in an extensible set of controlled terminology.
    slots:
      - enumeration
      - sponsorTerms
    unique_keys:
      enumeration:
        description: There should only be one terminology extension for any enumeration, which of which may contain multiple sponsor terms.
        unique_key_slots:
          - enumeration

  SponsorTerm:
    description: A sponsor-defined term that is included in an extensible set of controlled terminology.
    slots:
      - id
      - submissionValue
      - description

slots:

  name:
    required: true

  listOfPlannedAnalyses:
    description: A structured list of the analyses defined for the reporting event.
    required: true
    range: NestedList

  listOfPlannedOutputs:
    description: An optional structured list of the outputs defined for the reporting event.
    required: false
    range: NestedList

  analysisSets:
    description: The analysis sets (subject populations) defined for the reporting event.
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: AnalysisSet

  analysisGroupings:
    description: Characteristics used to subdivide the subject population (e.g., treatment, sex, age group).
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: SubjectGroupingFactor

  groupingVariable:
    description: For groupings based on a single variable, a reference to the dataset variable upon which grouping is based.

  dataDriven:
    description: Indicates whether the groups defined by the grouping are prespecified (false) or obtained from distinct data values of the groupingVariable (true).
    range: boolean
    required: true

  groups:
    multivalued: true
    list_elements_ordered: true
    inlined: true
    inlined_as_list: true
    range: Group

  dataSubsets:
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: DataSubset

  dataGroupings:
    description: Characteristics used to subdivide data records in the analysis dataset (e.g., visit, system organ class).
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: DataGroupingFactor

  analyses:
    description: The analyses defined for the reporting event.
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: Analysis

  reason:
    description: The rationale for performing this analysis. It indicates when the analysis was planned.
    required: true
    any_of:
      - range: AnalysisReason
      - range: SponsorTerm
    inlined: false

  purpose:
    description: The purpose of the analysis within the body of evidence (e.g., section in the clinical study report).
    required: true
    any_of:
      - range: AnalysisPurpose
      - range: SponsorTerm
    inlined: false

  methods:
    description: The defined methods used to analyze any analysis variable.
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: AnalysisMethod

  operations:
    required: true
    multivalued: true
    range: Operation
    inlined: true
    inlined_as_list: true

  referencedOperationId:
    range: ReferencedOperationRelationship
    inlined: false

  analysisCategorizations:
    multivalued: true
    range: AnalysisCategorization
    inlined: true
    inlined_as_list: true

  categories:
    multivalued: true
    range: AnalysisCategory
    inlined: true
    inlined_as_list: true
    required: true

  categoryIds:
    multivalued: true
    range: AnalysisCategory
    inlined: false
    required: false

  subCategorizations:
    multivalued: true
    range: AnalysisCategorization
    inlined: true
    inlined_as_list: true

  outputs:
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: Output

  listItems:
    multivalued: true
    list_elements_ordered: true
    inlined: true
    inlined_as_list: true
    range: OrderedListItem

  level:
    range: integer

  order:
    range: integer

  sublist: 
    range: NestedList
    multivalued: false
    inlined: true

  analysisId: 
    range: Analysis
    multivalued: false
    inlined: false

  analysisSetId: 
    range: AnalysisSet
    multivalued: false
    inlined: false

  orderedGroupings: 
    range: OrderedGroupingFactor
    multivalued: true
    list_elements_ordered: true
    inlined: true
    inlined_as_list: true

  groupingId: 
    range: GroupingFactor
    inlined: false

  resultsByGroup:
    description: Indicates whether a result is expected for each group in the grouping.
    range: boolean
    required: true

  dataSubsetId:
    inlined: false
    range: DataSubset

  methodId:  
    range: AnalysisMethod
    required: true
    inlined: false

  description:

  referencedAnalysisOperations:
    multivalued: true
    range: ReferencedAnalysisOperation
    inlined: true
    inlined_as_list: true    

  resultPattern:
  
  results:
    multivalued: true
    range: OperationResult
    inlined: true
    inlined_as_list: true

  resultGroups:
    multivalued: true
    range: ResultGroup
    inlined: true
    inlined_as_list: true

  groupId:
    range: Group
    inlined: false

  groupValue:

  rawValue:

  formattedValue:

  referencedOperationRelationships:
    multivalued: true
    range: ReferencedOperationRelationship
    inlined: true
    inlined_as_list: true
  
  referencedOperationRole:
    required: true
    any_of:
      - range: OperationRole
      - range: SponsorTerm
    inlined: false

  operationId:  
    range: Operation
    required: true
    inlined: false

  codeTemplate:
    description: Template programming statements and/or a reference to the template program used to perform the specific analysis.
    range: ProgrammingCodeTemplate

  context:
    description: The name and version of the computer language used for the actual programming statements provided.
    examples:
      - value: SAS Version 9.2
    range: string
    required: true

  parameters:
    description: Replacement parameters referenced in the programming code template.
    range: CodeParameter
    multivalued: true
    inlined: true
    inlined_as_list: true

  templateCode:
    description: Template programming statements and/or a reference to the template program used to perform the specific analysis.
    any_of:
      - range: string
      - range: DocumentRef

  valueSource:
    # TODO: restrict to formal references to attributes of instances of the parent Analysis class.
    description: A reference to the prespecified source of the value for the parameter.
    range: string

  outputId: 
    range: Output
    multivalued: false
    inlined: false

  id:
    required: true
    identifier: true
    range: string

  version:
    range: integer

  displayTitle:

  fileSpecifications:
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: File

  fileType:
    any_of:
      - range: OutputFileType
      - range: SponsorTerm
    inlined: false

  location:
    range: uri

  style:

  displays:
    range: OrderedDisplay
    multivalued: true
    inlined: true
    inlined_as_list: true
    list_elements_ordered: true

  display:
    range: OutputDisplay
    inlined: true

  globalDisplaySections:
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: DisplaySection

  displaySections:
    multivalued: true
    inlined: true
    inlined_as_list: true
    range: DisplaySection

  sectionType:
    range: DisplaySectionType

  subSections:
    multivalued: true
    list_elements_ordered: true
    inlined: true
    inlined_as_list: true
    range: DisplaySubSection

  text:

  logicalOperator:
    required: true
    range: ExpressionLogicalOperator

  condition:
    range: WhereClauseCondition

  compoundExpression:
    range: WhereClauseCompoundExpression

  whereClauses:
    multivalued: true
    list_elements_ordered: true
    inlined: false
    range: WhereClause

  dataset:

  variable:

  comparator:
    range: ConditionComparator

  value:
    multivalued: true

  label:

  referenceDocuments:
    multivalued: true
    range: ReferenceDocument
    inlined: true

  documentRefs:
    multivalued: true
    range: DocumentRef
    inlined: true

  referenceDocumentId:
    range: ReferenceDocument
    required: true
    inlined: false

  pageRefs:
    multivalued: true
    range: PageRef

  refType:
    required: true
    range: PageRefType

  pages:
    any_of:
      - range: PageNumberList
      - range: PageNameList
      - range: PageRange

  pageNumbers:
    description: One or more page numbers.
    range: integer
    multivalued: true
    required: true

  pageNames:
    description: One or more named document references which each correspond with a page.
    range: integer
    multivalued: true
    required: true 

  firstPage:
    description: The page number of the first page in a range of pages.
    range: integer
    required: true

  lastPage:
    description: The page number of the last page in a range of pages.
    range: integer
    required: true

  terminologyExtentions:
    description: Any sponsor-defined extensions to extensible terminology.
    range: TerminologyExtension
    multivalued: true
    inlined: true
    inlined_as_list: true

  enumeration:
    description: The name of the extensible enumeration.
    range: ExtensibleTerminology

  sponsorTerms:
    description: The sponsor-defined terms added to the extensible terminology.
    multivalued: true
    required: true
    range: SponsorTerm
    inlined: true
    inlined_as_list: true

  submissionValue:
    description: The specific value expected for submissions.
    range: string
    required: true

enums:

  OutputFileType:
    permissible_values:
      pdf:
      rtf:
      txt:

  ExpressionLogicalOperator:
    permissible_values:
      AND:
      OR:
      NOT:

  ConditionComparator:
    permissible_values:
      EQ:
      NE:
      GT:
      GE:
      LT:
      LE:
      IN:
      NOTIN:

  DisplaySectionType:
    permissible_values:
      Title:
      Footnote:
      Abbreviation:
      Legend:
      Rowlabel Header:

  OperationRole:
    permissible_values:
      NUMERATOR:
      DENOMINATOR:

  AnalysisReason:
  # TODO: change to a dynamic enum based on the NCI or CDISC terminology with extending terms.
    description: The rationale for performing this analysis. It indicates when the analysis was planned.
    code_set: NCIT:C117744
    permissible_values:
      SPECIFIED IN PROTOCOL:
        description: The analysis is specified in a protocol.
        meaning: NCIT:C117752
      SPECIFIED IN SAP:
        description: The analysis is specified in a statistical analysis plan.
        meaning: NCIT:C117753
      DATA DRIVEN:
        description: The analysis was triggered by findings in the data.
        meaning: NCIT:C117750
      REQUESTED BY REGULATORY AGENCY:
        description: The analysis has been requested by a regulatory agency.
        meaning: NCIT:C117751

  AnalysisPurpose:
  # TODO: change to a dynamic enum based on the NCI or CDISC terminology with extending terms.
    description: The purpose of the analysis within the body of evidence (e.g., section in the clinical study report).
    code_set: NCIT:C117745
    permissible_values:
      PRIMARY OUTCOME MEASURE:
        description: >-
          The outcome measure(s) of greatest importance specified in the protocol, usually the one(s) used in the power
          calculation, to evaluate the primary endpoint(s) associated with the primary study objective(s). (After
          Clinicaltrials.gov)
        meaning: NCIT:C98772
      SECONDARY OUTCOME MEASURE:
        description: >-
          The outcome measure(s) that is part of a pre-specified analysis plan used to evaluate the secondary endpoint(s)
          associated with secondary study objective(s) and/or used to evaluate any measure(s) ancillary to the primary or
          secondary endpoint(s). (After Clinicaltrials.gov).
        meaning: NCIT:C98781
      EXPLORATORY OUTCOME MEASURE:
        description: >-
          The outcome measure(s) that is part of a pre-specified analysis plan used to evaluate the exploratory endpoint(s)
          associated with exploratory study objective(s) and/or any other measures, excluding post-hoc measures, that are a
          focus of the study. (After clinicaltrials.gov)
        meaning: NCIT:C98724

  ExtensibleTerminology:
    description: Extensible ARS enumerations.
    permissible_values:
      AnalysisReason:
        description: The rationale for performing this analysis. It indicates when the analysis was planned.
        meaning: NCIT:C117744
      AnalysisPurpose:
        description: The purpose of the analysis within the body of evidence (e.g., section in the clinical study report).
        meaning: NCIT:C117745
      OperationRole:
      OutputFileType:

  PageRefType:
    description: Type of page for page references.
    permissible_values:
      PhysicalRef:
        description: References are to page numbers.
      NamedDestination:
        description: References are to named destinations in the referenced document.
